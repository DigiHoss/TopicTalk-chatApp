{% extends 'base.html' %}
{% block title %}Recover Password{% endblock %}

{% block content %}
<h2>Recover Password</h2>

{% with messages = get_flashed_messages(with_categories=true) %}
  {% if messages %}
    <ul>
    {% for category, message in messages %}
      <li class="">{{ message }}</li>
    {% endfor %}
    </ul>
  {% endif %}
{% endwith %}

<form action="" method="post">
    <p>Select what you remember:</p>

    <input type="radio" name="recover_method" id="email_selected" value="email" checked>
    <label for="email_selected">Email</label>

    <input type="radio" name="recover_method" id="username_selected" value="username">
    <label for="username_selected">Username</label>

    <br><br>

    <label id="method" for="methodInput">Email</label>
    <input type="text" name="email" id="methodInput" placeholder="Enter your email">
    <input type="submit" value="send code">

    
</form>

<form action="/verify-otp" method="post" style="display: block;">
    <label for="OTP">Verify Email</label>
    <input type="number" name="OTP">
    <input type="submit" value="verify code">
</form>

<form action="/ChangePassword" method="post" style="display: block;">
    <h3>Please enter a new password</h3>
    <label for="">New Password</label>
    <input type="password" name="new_password" id="">
    <label for="">Confirm Password</label>
    <input type="password" name="confirm_new_password" id="">
    <input type="submit" value="confirm">
</form>
<script>
    const methodLabel = document.getElementById('method');
    const methodInput = document.getElementById('methodInput');

    function updateMethod() {
        const selected = document.querySelector('input[name="recover_method"]:checked');
        if (!selected) return;

        const label = selected.value === 'email' ? 'Email' : 'Username';

        methodLabel.textContent = label;
        methodInput.name = selected.value;
        methodInput.placeholder = `Enter your ${label.toLowerCase()}`;
    }

    // Run on page load
    updateMethod();

    // Update on change
    document.querySelectorAll('input[name="recover_method"]').forEach(radio => {
        radio.addEventListener('change', updateMethod);
    });
</script>
{% endblock %}
